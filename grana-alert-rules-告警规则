
K8S:
1、Title: K8S Nodes Machine-Memory
(node_memory_MemTotal_bytes - (node_memory_MemFree_bytes + node_memory_Buffers_bytes+node_memory_Cached_bytes ))/node_memory_MemTotal_bytes * 100
Description: K8S Nodes Machine-Memory {{ $labels.instance }} 使用率大于85%，当前值：{{ index $values "B" }}%

方法二：sum(
    (node_memory_MemTotal_bytes{job="rke-a-prom"} - (node_memory_MemFree_bytes{job="rke-a-prom"} + node_memory_Buffers_bytes{job="rke-a-prom"} + node_memory_Cached_bytes{job="rke-a-prom"})) / node_memory_MemTotal_bytes{job="rke-a-prom"} * 100
) by (host_ip)



2、Title: K8s Nodes CPU Usage Alerts
PromQL: 100 -avg(irate(node_cpu_seconds_total{mode="idle"}[5m])) by (instance,job) * 100
Description:  The Dev K8S Node {{ $labels.instance }} CPU Usage is Over 85%. Current Value is: {{ index $values "B" }}%

3、Title: K8S Nodes Machine-Disk
PromQL:  (node_filesystem_size_bytes - node_filesystem_free_bytes)/node_filesystem_size_bytes * 100
Description:   K8S Nodes Machine-Disk 使用率大于85%，当前值：{{ index $values "B" }}%

方法二： 
ceil(100 - ((sum(node_filesystem_avail_bytes{job="rke-a-prom", device!~"rootfs"}) by (exported_instance, mountpoint) * 100) 
  / sum(node_filesystem_size_bytes{job="rke-a-prom", device!~"rootfs"}) by (exported_instance, mountpoint)))


4、Title: k8s Pod Restart 
PromQL: increase(kube_pod_container_status_restarts_total[1h])
Description:   pod在1h内重启次数超过1次
